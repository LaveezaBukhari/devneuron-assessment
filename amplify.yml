version: 1
frontend:
  phases:
    # The PREBUILD phase is for installing dependencies
    preBuild:
      commands:
        # 1. Navigate into your app's directory
        - cd frontend
        # 2. Install dependencies
        - npm install
    # The BUILD phase is for building your app
    build:
      commands:
        # This command will now correctly run inside the 'frontend' directory
        - npm run build
  # The ARTIFACTS section tells Amplify where your built app is
  artifacts:
    # This path must be relative to the project root
    baseDirectory: frontend/.next
    files:
      - '**/*'
  # The CACHE section speeds up future builds
  cache:
    paths:
      # This path must also be relative to the project root
      - frontend/node_modules/**/*
